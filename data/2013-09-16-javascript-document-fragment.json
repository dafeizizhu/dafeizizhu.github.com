{"year":"2013","month":"09","day":"16","filePath":"/home/dafeizizhu/workspace/github/dafeizizhu/dafeizizhu.github.com/site/posts/2013/09/16/javascript-document-fragment.html","fileName":"javascript-document-fragment","layout":"post","title":"Document Fragment","description":"","tags":["JavaScript"],"markdownText":"\n\n\n如果我们需要对一些DOM进行操作，而又不想这些操作造成的变化体现在浏览器中，可以创建一个文档片段（Document Fragment）临时把我们要操作的DOM放入其中，待操作完成后再放回原来的位置。\n\n### Document Fragment\n____\n\n> The DocumentFragment interface represents a minimal document object that has no parent. It is used as a light-weight version of Document to store well-formed or potentially non-well-formed fragments of XML.\n\n一个文档片段相当于一个轻量级的文档，可以存放一部分的XML（HTML）DOM。可以通过`document.createDocumentFragment`来创建一个文档片段。\n\n其实一个文档片段就是一个小型的文档，可以使用`appendChild`加入DOM、使用`childNodes`去获取文档片段中的子元素等。\n\n### document.createDocumentFragment\n____\n\n上文已经提到了这个方法。这个方法的作用就是创建一个空白的文档片段，所以这个方法不接受任何参数，而返回一个文档片段的DOM。这个DOM不在当前的文档树中。通常会在这个文档片段中进行DOM操作，例如从某个地方使用`appendChild`把相关的DOM插入到文档片段中，然后对文档片段中的DOM进行修改或者删除，最后把这个文档片段（或者只把它的子元素）插入到当前的文档树中。这时这些DOM操作才真正生效。\n\n由于这种操作方式不会导致页面的reflow，所以使用文档片段去操作DOM是一种效率比较高的方式，建议使用。\n\n### range.createContextualFragment\n____\n\n今天看书的时候提到了一种比`document.createFragment`效率更高的方式，就是`range.createContexualFragment`，其中`range`是通过`document.createRange`创建的对象。\n\n> The Range.createContextualFragment() method returns a DocumentFragment by invoking the HTML fragment parsing algorithm or the XML fragment parsing algorithm with the start of the range (the parent of the selected node) as the context node.\n\n这个方法的作用是使用`range`所表示的选择区域去创建一个文档片段，即这个方法也是返回一个文档片段。跟`document.createFragment`不同的是：\n\n1. 需要以选中的开始元素作为文档片段的上下文。\n2. 接受一个参数，就是HTML格式的字符串。\n\n创建的文档片段会自动包括该参数表示的DOM。例子[参考这里](http://jsfiddle.net/ppS3x/)。\n\n这个方法会调用浏览器解析XML或者HTML的解析器去转化这个HTML字符串，类似于`innerHTML`属性，一方面效率会比较高，另一方面使用起来也比较方便。由于只是一个实验性质的API，所以不是所有浏览器都支持，特别是IE哦亲！\n","htmlText":"<p>如果我们需要对一些DOM进行操作，而又不想这些操作造成的变化体现在浏览器中，可以创建一个文档片段（Document Fragment）临时把我们要操作的DOM放入其中，待操作完成后再放回原来的位置。</p>\n<h3 id=\"document-fragment\">Document Fragment</h3>\n<hr>\n<blockquote>\n<p>The DocumentFragment interface represents a minimal document object that has no parent. It is used as a light-weight version of Document to store well-formed or potentially non-well-formed fragments of XML.</p>\n</blockquote>\n<p>一个文档片段相当于一个轻量级的文档，可以存放一部分的XML（HTML）DOM。可以通过<code>document.createDocumentFragment</code>来创建一个文档片段。</p>\n<p>其实一个文档片段就是一个小型的文档，可以使用<code>appendChild</code>加入DOM、使用<code>childNodes</code>去获取文档片段中的子元素等。</p>\n<h3 id=\"document-createdocumentfragment\">document.createDocumentFragment</h3>\n<hr>\n<p>上文已经提到了这个方法。这个方法的作用就是创建一个空白的文档片段，所以这个方法不接受任何参数，而返回一个文档片段的DOM。这个DOM不在当前的文档树中。通常会在这个文档片段中进行DOM操作，例如从某个地方使用<code>appendChild</code>把相关的DOM插入到文档片段中，然后对文档片段中的DOM进行修改或者删除，最后把这个文档片段（或者只把它的子元素）插入到当前的文档树中。这时这些DOM操作才真正生效。</p>\n<p>由于这种操作方式不会导致页面的reflow，所以使用文档片段去操作DOM是一种效率比较高的方式，建议使用。</p>\n<h3 id=\"range-createcontextualfragment\">range.createContextualFragment</h3>\n<hr>\n<p>今天看书的时候提到了一种比<code>document.createFragment</code>效率更高的方式，就是<code>range.createContexualFragment</code>，其中<code>range</code>是通过<code>document.createRange</code>创建的对象。</p>\n<blockquote>\n<p>The Range.createContextualFragment() method returns a DocumentFragment by invoking the HTML fragment parsing algorithm or the XML fragment parsing algorithm with the start of the range (the parent of the selected node) as the context node.</p>\n</blockquote>\n<p>这个方法的作用是使用<code>range</code>所表示的选择区域去创建一个文档片段，即这个方法也是返回一个文档片段。跟<code>document.createFragment</code>不同的是：</p>\n<ol>\n<li>需要以选中的开始元素作为文档片段的上下文。</li>\n<li>接受一个参数，就是HTML格式的字符串。</li>\n</ol>\n<p>创建的文档片段会自动包括该参数表示的DOM。例子<a href=\"http://jsfiddle.net/ppS3x/\">参考这里</a>。</p>\n<p>这个方法会调用浏览器解析XML或者HTML的解析器去转化这个HTML字符串，类似于<code>innerHTML</code>属性，一方面效率会比较高，另一方面使用起来也比较方便。由于只是一个实验性质的API，所以不是所有浏览器都支持，特别是IE哦亲！</p>\n","summaryMarkdownText":"\n\n\n如果我们需要对一些DOM进行操作，而又不想这些操作造成的变化体现在浏览器中，可以创建一个文档片段（Document Fragment）临时把我们要操作的DOM放入其中，待操作完成后再放回原来的位置。\n\n### Document Fragment\n____\n\n> The DocumentFragment interface represents a minimal document object that has no parent. It is used as a light-weight version of Document to store well-formed or potentially non-well-formed fragments of XML.\n\n一个文档片段相当于一个轻量级的文档，可以存放一部分的XML（HTML）DOM。可以通过`document.createDocumentFragment`来创建一个文档片段。\n\n其实一个文档片段就是一个小型的文档，可以使用`appendChild`加入DOM、使用`childNodes`去获取文档片段中的子元素等。\n\n### document.createDocumentFragment\n____\n\n上文已经提到了这个方法。这个方法的作用就是创建一个空白的文档片段，所以这个方法不接受任何参数，而返回一个文档片段的DOM。这个DOM不在当前的文档树中。通常会在这个文档片段中进行DOM操作，例如从某个地方使用`appendChild`把相关的DOM插入到文档片段中，然后对文档片段中的DOM进行修改或者删除，最后把这个文档片段（或者只把它的子元素）插入到当前的文档树中。这时这些DOM操作才真正生效。\n\n由于这种操作方式不会导致页面的reflow，所以使用文档片段去操作DOM是一种效率比较高的方式，建议使用。\n\n### range.createContextualFragment\n____\n\n今天看书的时候提到了一种比`document.createFragment`效率更高的方式，就是`range.createContexualFragment`，其中`range`是通过`document.createRange`创建的对象。","summaryHtmlText":"<p>如果我们需要对一些DOM进行操作，而又不想这些操作造成的变化体现在浏览器中，可以创建一个文档片段（Document Fragment）临时把我们要操作的DOM放入其中，待操作完成后再放回原来的位置。</p>\n<h3 id=\"document-fragment\">Document Fragment</h3>\n<hr>\n<blockquote>\n<p>The DocumentFragment interface represents a minimal document object that has no parent. It is used as a light-weight version of Document to store well-formed or potentially non-well-formed fragments of XML.</p>\n</blockquote>\n<p>一个文档片段相当于一个轻量级的文档，可以存放一部分的XML（HTML）DOM。可以通过<code>document.createDocumentFragment</code>来创建一个文档片段。</p>\n<p>其实一个文档片段就是一个小型的文档，可以使用<code>appendChild</code>加入DOM、使用<code>childNodes</code>去获取文档片段中的子元素等。</p>\n<h3 id=\"document-createdocumentfragment\">document.createDocumentFragment</h3>\n<hr>\n<p>上文已经提到了这个方法。这个方法的作用就是创建一个空白的文档片段，所以这个方法不接受任何参数，而返回一个文档片段的DOM。这个DOM不在当前的文档树中。通常会在这个文档片段中进行DOM操作，例如从某个地方使用<code>appendChild</code>把相关的DOM插入到文档片段中，然后对文档片段中的DOM进行修改或者删除，最后把这个文档片段（或者只把它的子元素）插入到当前的文档树中。这时这些DOM操作才真正生效。</p>\n<p>由于这种操作方式不会导致页面的reflow，所以使用文档片段去操作DOM是一种效率比较高的方式，建议使用。</p>\n<h3 id=\"range-createcontextualfragment\">range.createContextualFragment</h3>\n<hr>\n<p>今天看书的时候提到了一种比<code>document.createFragment</code>效率更高的方式，就是<code>range.createContexualFragment</code>，其中<code>range</code>是通过<code>document.createRange</code>创建的对象。</p>\n"}