{"year":"2013","month":"08","day":"15","filePath":"/home/dafeizizhu/workspace/github/dafeizizhu/dafeizizhu.github.com/site/posts/2013/08/15/ie-conditional-comment.html","fileName":"ie-conditional-comment","layout":"post","title":"IE条件注释","description":"","tags":["html"],"markdownText":"\n\n\nIE条件注释提供了一个浏览器端的手段，去做浏览器检测。这个手段不需要去判断`window.navigator`，所以不用担心各种`navigator`的篡改。但是这个手段目前只能用在IE上，但是，这不就已经够了吗？\n\n**注意，IE10已经不支持条件注释了**。但是貌似IE10已经向W3的规范靠拢了，影响应该不大。\n\nIE的条件注释原来有两种：\n\n1. 不支持条件注释的浏览器不显示：`<!--[if IE 8]>...<![endif]-->`\n2. 不支持条件注释的浏览器显示：`<![if IE 8]>...<![endif]>`\n\n原理很简单，由于前者跟HTML的注释要求的格式是一样的，所以在不支持条件注释的浏览器会认为这个是一个HTML的注释，不会解析里面的HTML片段。而后者则是被认为是一个HTML标签（虽然明显不符合XML的规范……），就会解析里面的HTML片段。\n\n前者可以为判断IE的版本决定是否需要加入额外的HTML、CSS、JavaScript来提供完整的功能，如在IE9以下的版本使用`canvas`，增加`exCanvas`的引用：\n\n    <!--[if lt IE 9]><script language=\"javascript\" type=\"text/javascript\" src=\"excanvas.js\"></script><![endif]-->\n\n后者可以提示一些非特定版本IE的用户使用特定版本IE，如：\n\n    <![if lt IE 8]>\n    <p>Please upgrade to Internet Explorer version 8.</p>\n    <![endif]>\n\n再来看看条件注释里面的表达式，由`if`以及后面的条件表达式组成。条件表达式有三种：\n\n1. `IE`，判断IE的版本，主版本使用整数表示，如果包含小版本则使用浮点数表示，如：`IE 5.5000`表示IE 5.5。\n2. `WindowsEdition`，判断浏览器运行的Windows的版本。对应的值<a href=\"http://msdn.microsoft.com/en-us/library/ms724358(v=vs.85).aspx\">参考这里</a>。\n3. 布尔值，`true`或者`false`。\n\n判断版本的时候可以使用以下几个操作符：\n\n1. `lt`或者`lte`，判断是否小于或者小于等于特定版本。\n2. `gt`或者`gte`，判断是否大于或者大于等于特定版本。\n3. 条件以及条件之间可以通过运算符`!`、`|`、`&`进行逻辑运算。\n\n还有一个比较有趣的就是可以在IE的插件里面判断当前插件的版本！在安装插件的时候为注册表增加以下的键值：\n\n    HKEY_LOCAL_MACHINE\n      Software\n        Microsoft\n          Internet Explorer\n            Version Vector\n              Contoso = 0.9\n\n在插件里面可以通过以下条件注释来判断当前插件的版本：\n\n    <!--[if lt Contoso 2]>\n    <p>Your version of the Contoso control is out of date; Please update to the latest.</p>\n    <![endif]-->\n\n严格来说，使用IE条件注释也算是CSS hack的一种。相对于其他CSS hack是使用浏览器的bug实现的，这个方式算是比较靠谱的一个方式，毕竟这个不是浏览器的bug，而是浏览器提供的一种做浏览器检测的手段。如果涉及的兼容性问题只出现在各种不同版本的IE里面，为了提高代码的可读性，可以把各种fixed的代码抽取到一个外部样式表中，再使用条件注释，指示特定版本的IE加载该外部样式表。如果涉及的问题还出现在FireFox、Chrome、Safari等浏览器中，那还得考虑除了条件注释之外的css hack。\n","htmlText":"<p>IE条件注释提供了一个浏览器端的手段，去做浏览器检测。这个手段不需要去判断<code>window.navigator</code>，所以不用担心各种<code>navigator</code>的篡改。但是这个手段目前只能用在IE上，但是，这不就已经够了吗？</p>\n<p><strong>注意，IE10已经不支持条件注释了</strong>。但是貌似IE10已经向W3的规范靠拢了，影响应该不大。</p>\n<p>IE的条件注释原来有两种：</p>\n<ol>\n<li>不支持条件注释的浏览器不显示：<code>&lt;!--[if IE 8]&gt;...&lt;![endif]--&gt;</code></li>\n<li>不支持条件注释的浏览器显示：<code>&lt;![if IE 8]&gt;...&lt;![endif]&gt;</code></li>\n</ol>\n<p>原理很简单，由于前者跟HTML的注释要求的格式是一样的，所以在不支持条件注释的浏览器会认为这个是一个HTML的注释，不会解析里面的HTML片段。而后者则是被认为是一个HTML标签（虽然明显不符合XML的规范……），就会解析里面的HTML片段。</p>\n<p>前者可以为判断IE的版本决定是否需要加入额外的HTML、CSS、JavaScript来提供完整的功能，如在IE9以下的版本使用<code>canvas</code>，增加<code>exCanvas</code>的引用：</p>\n<pre><code>&lt;!--[if lt IE 9]&gt;&lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot; src=&quot;excanvas.js&quot;&gt;&lt;/script&gt;&lt;![endif]--&gt;\n</code></pre><p>后者可以提示一些非特定版本IE的用户使用特定版本IE，如：</p>\n<pre><code>&lt;![if lt IE 8]&gt;\n&lt;p&gt;Please upgrade to Internet Explorer version 8.&lt;/p&gt;\n&lt;![endif]&gt;\n</code></pre><p>再来看看条件注释里面的表达式，由<code>if</code>以及后面的条件表达式组成。条件表达式有三种：</p>\n<ol>\n<li><code>IE</code>，判断IE的版本，主版本使用整数表示，如果包含小版本则使用浮点数表示，如：<code>IE 5.5000</code>表示IE 5.5。</li>\n<li><code>WindowsEdition</code>，判断浏览器运行的Windows的版本。对应的值<a href=\"http://msdn.microsoft.com/en-us/library/ms724358(v=vs.85).aspx\">参考这里</a>。</li>\n<li>布尔值，<code>true</code>或者<code>false</code>。</li>\n</ol>\n<p>判断版本的时候可以使用以下几个操作符：</p>\n<ol>\n<li><code>lt</code>或者<code>lte</code>，判断是否小于或者小于等于特定版本。</li>\n<li><code>gt</code>或者<code>gte</code>，判断是否大于或者大于等于特定版本。</li>\n<li>条件以及条件之间可以通过运算符<code>!</code>、<code>|</code>、<code>&amp;</code>进行逻辑运算。</li>\n</ol>\n<p>还有一个比较有趣的就是可以在IE的插件里面判断当前插件的版本！在安装插件的时候为注册表增加以下的键值：</p>\n<pre><code>HKEY_LOCAL_MACHINE\n  Software\n    Microsoft\n      Internet Explorer\n        Version Vector\n          Contoso = 0.9\n</code></pre><p>在插件里面可以通过以下条件注释来判断当前插件的版本：</p>\n<pre><code>&lt;!--[if lt Contoso 2]&gt;\n&lt;p&gt;Your version of the Contoso control is out of date; Please update to the latest.&lt;/p&gt;\n&lt;![endif]--&gt;\n</code></pre><p>严格来说，使用IE条件注释也算是CSS hack的一种。相对于其他CSS hack是使用浏览器的bug实现的，这个方式算是比较靠谱的一个方式，毕竟这个不是浏览器的bug，而是浏览器提供的一种做浏览器检测的手段。如果涉及的兼容性问题只出现在各种不同版本的IE里面，为了提高代码的可读性，可以把各种fixed的代码抽取到一个外部样式表中，再使用条件注释，指示特定版本的IE加载该外部样式表。如果涉及的问题还出现在FireFox、Chrome、Safari等浏览器中，那还得考虑除了条件注释之外的css hack。</p>\n","summaryMarkdownText":"\n\n\nIE条件注释提供了一个浏览器端的手段，去做浏览器检测。这个手段不需要去判断`window.navigator`，所以不用担心各种`navigator`的篡改。但是这个手段目前只能用在IE上，但是，这不就已经够了吗？\n\n**注意，IE10已经不支持条件注释了**。但是貌似IE10已经向W3的规范靠拢了，影响应该不大。\n\nIE的条件注释原来有两种：\n\n1. 不支持条件注释的浏览器不显示：`<!--[if IE 8]>...<![endif]-->`\n2. 不支持条件注释的浏览器显示：`<![if IE 8]>...<![endif]>`\n\n原理很简单，由于前者跟HTML的注释要求的格式是一样的，所以在不支持条件注释的浏览器会认为这个是一个HTML的注释，不会解析里面的HTML片段。而后者则是被认为是一个HTML标签（虽然明显不符合XML的规范……），就会解析里面的HTML片段。\n\n前者可以为判断IE的版本决定是否需要加入额外的HTML、CSS、JavaScript来提供完整的功能，如在IE9以下的版本使用`canvas`，增加`exCanvas`的引用：\n\n    <!--[if lt IE 9]><script language=\"javascript\" type=\"text/javascript\" src=\"excanvas.js\"></script><![endif]-->\n\n后者可以提示一些非特定版本IE的用户使用特定版本IE，如：\n\n    <![if lt IE 8]>\n    <p>Please upgrade to Internet Explorer version 8.</p>\n    <![endif]>\n\n再来看看条件注释里面的表达式，由`if`以及后面的条件表达式组成。条件表达式有三种：","summaryHtmlText":"<p>IE条件注释提供了一个浏览器端的手段，去做浏览器检测。这个手段不需要去判断<code>window.navigator</code>，所以不用担心各种<code>navigator</code>的篡改。但是这个手段目前只能用在IE上，但是，这不就已经够了吗？</p>\n<p><strong>注意，IE10已经不支持条件注释了</strong>。但是貌似IE10已经向W3的规范靠拢了，影响应该不大。</p>\n<p>IE的条件注释原来有两种：</p>\n<ol>\n<li>不支持条件注释的浏览器不显示：<code>&lt;!--[if IE 8]&gt;...&lt;![endif]--&gt;</code></li>\n<li>不支持条件注释的浏览器显示：<code>&lt;![if IE 8]&gt;...&lt;![endif]&gt;</code></li>\n</ol>\n<p>原理很简单，由于前者跟HTML的注释要求的格式是一样的，所以在不支持条件注释的浏览器会认为这个是一个HTML的注释，不会解析里面的HTML片段。而后者则是被认为是一个HTML标签（虽然明显不符合XML的规范……），就会解析里面的HTML片段。</p>\n<p>前者可以为判断IE的版本决定是否需要加入额外的HTML、CSS、JavaScript来提供完整的功能，如在IE9以下的版本使用<code>canvas</code>，增加<code>exCanvas</code>的引用：</p>\n<pre><code>&lt;!--[if lt IE 9]&gt;&lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot; src=&quot;excanvas.js&quot;&gt;&lt;/script&gt;&lt;![endif]--&gt;\n</code></pre><p>后者可以提示一些非特定版本IE的用户使用特定版本IE，如：</p>\n<pre><code>&lt;![if lt IE 8]&gt;\n&lt;p&gt;Please upgrade to Internet Explorer version 8.&lt;/p&gt;\n&lt;![endif]&gt;\n</code></pre><p>再来看看条件注释里面的表达式，由<code>if</code>以及后面的条件表达式组成。条件表达式有三种：</p>\n"}