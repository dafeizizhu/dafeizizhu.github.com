<!DOCTYPE html>
<html>

  <head>
    <title>Secrets of the JavaScript Ninja 读书笔记之 跨浏览器需要关心的东西</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="/common/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/blog.css">
  </head>

  <body>
    <div class="blog-masthead">
      <div class="container">
        <nav class="blog-nav"><a href="/" class="blog-nav-item active">主页</a><a href="/posts" class="blog-nav-item">文章</a><a href="/tags" class="blog-nav-item">标签</a><a href="/projects" class="blog-nav-item">项目</a><a href="/about" class="blog-nav-item">关于</a></nav>
      </div>
    </div>
    <div class="container">
      <div class="blog-header">
        <h1 class="blog-title">小麦的二三事</h1>
        <p class="lead blog-description">他大舅他二舅，都是他舅</p>
      </div>
      <div class="col-sm-8 blog-main">
        <div class="row">
          <div class="blog-post">
            <h2 class="blog-post-title">Secrets of the JavaScript Ninja 读书笔记之 跨浏览器需要关心的东西</h2>
            <p class="blog-post-meta">写于2013年08月31日 关于<a href="/tags/JavaScript">JavaScript</a></p>
            <p>又到了周末读书的时间啦！今天带来跨浏览器编码需要关心的几个东西。</p>
            <h3 id="-bugs">浏览器的Bugs</h3>
            <hr>
            <p>其中一个最重要的点是我们需要了解，需要支持的数个浏览器中的bugs还有浏览器之间各种API的区别。完成代码的编写之后，最重要的是需要一套完整的测试用例，以便保证各种需要支持的浏览器上面不会出现问题。更重要的是我们需要持续进行测试，以防止浏览器更新之后的各种异常场景。</p>
            <h3 id="-bugs">修复浏览器的Bugs</h3>
            <hr>
            <p>要保证我们对于浏览器的Bugs的规避方法在浏览器修复对应Bugs之后还是可行的。更可靠的方式是做特性检测，而不是去做浏览器检测（检测会发生该bug的浏览器或者特定版本等）。</p>
            <p>规避浏览器的bug可能会造成以下两个麻烦：</p>
            <ol>
              <li>规避的代码很容易在浏览器本身修复该bug之后失效。</li>
              <li>由于害怕浏览器修复bug之后的造成的麻烦，我们可能会停止催促浏览器厂商去修改这些bugs。</li>
            </ol>
            <p>久而久之，会导致一些bug被当作是正确的使用方式，而真正正确的使用方式则被当作是“ bug”了。</p>
            <p>而bug跟非标准的API也有区别。有时候我们为了向下兼容，会为低版本的浏览器自定义高版本浏览器对应的非标准API功能。这时候要注意，当浏览器升级之后，这些API的表现是否跟我们增加的API一致，因为这些非标准API什么时候都有可能改变的。相对的，浏览器的bug的修复是可遇见的，通常跟我们的预期是一致的。</p>
            <h3 id="-">与外部代码共存</h3>
            <hr>
            <p>构建可重用的代码其中一个很重要的问题，就是如何与外部代码共存。一方面，我们自己编写的代码应该尽量避免影响外部代码的行为。另一方面，我们也要防止外部代码影响我们编写的代码的相关功能。</p>
            <p>为了实现以上的目的，我们可以：</p>
            <ol>
              <li>使用闭包封装我们编写的代码。</li>
              <li>防止外部代码植入的属性，例如在<code>prototype</code>中新增的属性，在遍历的时候使用<code>hasOwnProperty</code>去避免遍历出这些别人新增的属性。</li>
            </ol>
            <p>除了外部代码，有时候一些浏览器的特性也会造成困扰的问题，例如<code>form</code>元素会自动为其中每一个表单域创建一个名字是表单域的<code>name</code>特性的属性，这样会导致当一个<code>form</code>中有一个<code>name</code>为<code>submit</code>的表单元素，而调用<code>form.submit()</code>的时候，那个<code>submit</code>是一个表单域而不是提交方法。这个不算bug，也只能通过避免使用<code>form</code>的方法名来命名表单域来规避，虽然这也不是一件十分难的事情。</p>
            <p>在编写一些与样式相关的代码时，要注意把样式写在脚本前面，才能保证脚本运行的时候样式已经被正确应用到HTML元素上面了。</p>
            <h3 id="-">向下兼容</h3>
            <hr>
            <p>通常，为了兼容我们需要支持的浏览器中一些上一代的版本，我们需要编写向下兼容的代码，以保证在这些低版本浏览器上功能的可用性（可以牺牲一些效果或者效率）。通过优雅的降级，在低版本的浏览器中只保证基本功能正确。这样可以保证为百分之九十的用户提供良好的用户体验，而为百分之九的用户提供最基础的功能，还有忽略那百分之一的使用老旧浏览器的顽固用户。</p>
            <p>有几个关键的点：</p>
            <ol>
              <li>不要为老的浏览器提供与新浏览器一样的用户体验，这样会很痛苦。</li>
              <li>保证所有需要支持的浏览器都提供完整的功能。</li>
              <li>假设未来的浏览器也能提供正确完整的功能。</li>
            </ol>
            <h3 id="-">浏览器退化</h3>
            <hr>
            <p>浏览器bug、浏览器对非标准API的修改，都有可能使我们的代码失效。有一些浏览器的API修改是可以预见的，例如IE9提供的标准API<code>addEventLisener</code>等。这种修改对我们的代码不会造成任何影响。</p>
            <p>更多的时候是一些未能预见的变更。这些问题只能通过无尽的测试才能预防了。最值得欣慰的一点是，浏览器厂商也会尽量避免这些退化行为，感谢上苍。</p>
            <nav class="pager">
              <li><a href="/posts/2013/08/30/jquery-html-source.html" title="jQuery源码解析之jQuery.fn.html">上一篇</a></li>
              <li><a href="/posts/2013/09/01/javascript-cross-browser-strategies.html" title="Secrets of the JavaScript Ninja 读书笔记之 跨浏览器编程策略">下一篇</a></li>
            </nav>
          </div>
        </div>
      </div>
      <div class="col-sm-3 col-sm-offset-1 blog-sidebar">
        <div class="sidebar-module">
          <h4>文章</h4>
          <ol class="list-unstyled">
            <li><a href="/posts/2014/02">2014年02月</a></li>
            <li><a href="/posts/2014/01">2014年01月</a></li>
            <li><a href="/posts/2013/12">2013年12月</a></li>
            <li><a href="/posts/2013/11">2013年11月</a></li>
            <li><a href="/posts/2013/10">2013年10月</a></li>
            <li><a href="/posts/2013/09">2013年09月</a></li>
            <li><a href="/posts/2013/08">2013年08月</a></li>
            <li><a href="/posts/2013/07">2013年07月</a></li>
            <li><a href="/posts/2013/01">2013年01月</a></li>
            <li><a href="/posts/2012/12">2012年12月</a></li>
          </ol>
        </div>
        <div class="sidebar-module">
          <h4>标签</h4>
          <ol class="list-unstyled">
            <li><a href="/tags/notes">notes(5)</a></li>
            <li><a href="/tags/css">css(23)</a></li>
            <li><a href="/tags/html">html(10)</a></li>
            <li><a href="/tags/JavaScript">JavaScript(106)</a></li>
            <li><a href="/tags/前端">前端(9)</a></li>
            <li><a href="/tags/jQuery">jQuery(29)</a></li>
            <li><a href="/tags/http">http(4)</a></li>
            <li><a href="/tags/node">node(3)</a></li>
            <li><a href="/tags/html5">html5(7)</a></li>
            <li><a href="/tags/Flash">Flash(30)</a></li>
          </ol>
        </div>
      </div>
    </div>
    <div class="container"></div>
    <footer class="blog-footer">
      <p>Powerby MaiZhiying</p>
    </footer>
  </body>

</html>