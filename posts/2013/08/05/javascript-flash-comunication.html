<!DOCTYPE html>
<html>

  <head>
    <title>JavaScript与Flash通信</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="/common/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/blog.css">
  </head>

  <body>
    <div class="blog-masthead">
      <div class="container">
        <nav class="blog-nav"><a href="/" class="blog-nav-item active">主页</a><a href="/posts" class="blog-nav-item">文章</a><a href="/tags" class="blog-nav-item">标签</a><a href="/projects" class="blog-nav-item">项目</a><a href="/about" class="blog-nav-item">关于</a></nav>
      </div>
    </div>
    <div class="container">
      <div class="blog-header">
        <h1 class="blog-title">小麦的二三事</h1>
        <p class="lead blog-description">他大舅他二舅，都是他舅</p>
      </div>
      <div class="col-sm-8 blog-main">
        <div class="row">
          <div class="blog-post">
            <h2 class="blog-post-title">JavaScript与Flash通信</h2>
            <p class="blog-post-meta">写于2013年08月05日 关于<a href="/tags/前端">前端</a></p>
            <p>虽然说iOS不支持Flash，但是Flash在桌面端的使用量还是很大的。作为一个专业的前端开发人员，至少也要懂得如何使用JavaScript与Flash进行通信。</p>
            <h3 id="javascript-flash">JavaScript =&gt; Flash</h3>
            <p>使用JavaScript调用Flash内部的方法。假设有以下Flash片段：</p> <pre><code>&lt;object type=&quot;application/x-shockwave-flash&quot; id=&quot;myFlashID&quot; width=&quot;85&quot; height=&quot;85&quot; data=&quot;framejump.swf&quot;&gt;
  &lt;param name=&quot;allowScriptAccess&quot; value=&quot;sameDomain&quot;&gt;
  &lt;param name=&quot;movie&quot; value=&quot;framejump.swf&quot;&gt;
  &lt;param name=&quot;quality&quot; value=&quot;high&quot;&gt;
  &lt;param name=&quot;scale&quot; value=&quot;noscale&quot;&gt;
  &lt;param name=&quot;wmode&quot; value=&quot;transparent&quot;&gt;
&lt;/object&gt;
</code></pre>
            <p>我们可以通过JavaScript先获取该Flash影片的引用：</p> <pre><code>function getFlashMovieObject(movieName){
  if (window.document[movieName]){
    return window.document[movieName];
  }else if (navigator.appName.indexOf(&quot;Microsoft&quot;)==-1){
    if (document.embeds &amp;&amp; document.embeds[movieName])
      return document.embeds[movieName];
  }else{
    return document.getElementById(movieName);
  }
}
</code></pre>
            <p>获取引用后，还需要Flash内部使用增加回调的方式暴露接口：</p> <pre><code>ExternalInterface.addCallback(&quot;frameJump&quot;, frameJump);
</code></pre>
            <p><code>frameJump</code>的代码如下：</p> <pre><code>function frameJump(whichFrame:String):void {
  gotoAndStop(whichFrame);
}
</code></pre>
            <p>这样就可以在JavaScript中直接调用该引用上的方法：</p> <pre><code>var flashObj = getFlashMovieObject(&quot;movieName&quot;);
flashObj.frameJump(5);
</code></pre>
            <p>例子<a href="http://iviewsource.com/exercises/javascripttoflash/">参考这里</a>。通过这个机制可以让JavaScript调用Flash中的方法。</p>
            <h3 id="flash-javascript">Flash =&gt; JavaScript</h3>
            <p>Flash调用JavaScript的方法是使用<code>ExternalInterface.call</code>这个方法去调用外部的JavaScript方法，使用方法很简单：</p> <pre><code>ExternalInterface.call(&quot;alert&quot;, &quot;This alert comes from Flash&quot;);
</code></pre>
            <p>其中第一个参数是全局作用域中的函数名称，后面的参数是传给要调用的JavaScript方法的参数。例子<a href="http://iviewsource.com/exercises/flashtojavascript/">参考这里</a>。</p>
            <p>参考资料：</p>
            <ol>
              <li><a href="http://iviewsource.com/codingtutorials/communication-between-javascript-and-flash/">Communication between JavaScript and Flash</a></li>
              <li><a href="http://www.imququ.com/post/39.html">Javascript与Flash通信全解析</a></li>
            </ol>
            <nav class="pager">
              <li><a href="/posts/2013/08/04/high-performance-javascript-read-note.html" title="High Performance JavaScript 读书笔记之 数据存取">上一篇</a></li>
              <li><a href="/posts/2013/08/06/css-ie-haslayout.html" title="IE的hasLayout">下一篇</a></li>
            </nav>
          </div>
        </div>
      </div>
      <div class="col-sm-3 col-sm-offset-1 blog-sidebar">
        <div class="sidebar-module">
          <h4>文章</h4>
          <ol class="list-unstyled">
            <li><a href="/posts/2014/02">2014年02月</a></li>
            <li><a href="/posts/2014/01">2014年01月</a></li>
            <li><a href="/posts/2013/12">2013年12月</a></li>
            <li><a href="/posts/2013/11">2013年11月</a></li>
            <li><a href="/posts/2013/10">2013年10月</a></li>
            <li><a href="/posts/2013/09">2013年09月</a></li>
            <li><a href="/posts/2013/08">2013年08月</a></li>
            <li><a href="/posts/2013/07">2013年07月</a></li>
            <li><a href="/posts/2013/01">2013年01月</a></li>
            <li><a href="/posts/2012/12">2012年12月</a></li>
          </ol>
        </div>
        <div class="sidebar-module">
          <h4>标签</h4>
          <ol class="list-unstyled">
            <li><a href="/tags/notes">notes(5)</a></li>
            <li><a href="/tags/css">css(23)</a></li>
            <li><a href="/tags/html">html(10)</a></li>
            <li><a href="/tags/JavaScript">JavaScript(106)</a></li>
            <li><a href="/tags/前端">前端(9)</a></li>
            <li><a href="/tags/jQuery">jQuery(29)</a></li>
            <li><a href="/tags/http">http(4)</a></li>
            <li><a href="/tags/node">node(3)</a></li>
            <li><a href="/tags/html5">html5(7)</a></li>
            <li><a href="/tags/Flash">Flash(30)</a></li>
          </ol>
        </div>
      </div>
    </div>
    <div class="container"></div>
    <footer class="blog-footer">
      <p>Powerby MaiZhiying</p>
    </footer>
  </body>

</html>