---
layout: post
title: "《JavaScript设计模式与开发实践》读书笔记"
description: ""
category: 
tags: [JavaScript, 读书笔记]
---

### 第5章 策略模式

要实现某一个功能有多种方案可以选择，这些算法灵活多样，而且可以随意互相替换，这种解决方案就是策略模式。

策略模式的定义是：定义一系列算法，把它们一个个封装起来，并且使它们可以互相替换。策略模式的目的就是将算法的使用与算法的实现分离开来。

一个基于策略模式的程序至少由两部分组成。第一个部分是一组策略类，策略类封装了具体的算法，并负责具体的计算过程。第二个部分是环境类，环境类接受客户的要求，随后把请求委托给某一个策略类。环境类需要维持对某一个策略类对象的引用。

在JavaScript语言中，函数也是对象，所以更简单和直接的做法是把策略类直接定义为函数：

    var stragities = {
      'S': function (salary) {
        return salary * 4
      },
      'A': function (salary) {
        return salary * 3
      },
      'B': function (salary) {
        return salary * 2
      }
    }

    var calculateBonus = function (level, salary) {
      return stragities[level](salary)
    }

    console.log(calculateBonus('S', 20000)) // output 80000
    console.log(calculateBonus('A', 10000)) // output 30000

通过使用策略模式重构代码，我们消除了原程序中大片的条件分支语句。每个策略对象负责的算法已被各自封装在对象内部。

策略模式的优点：

1. 策略模式利用组合、委托和多态等技术和思想，可以有效地避免多重条件选择语句。
2. 策略模式提供了对开放-封闭原则的完美支持，将算法封装在独立的策略类中，使得它们易于切换，易于理解，易于扩展。
3. 策略模式中的算法也可以复用在系统的其他地方，避免许多重复的复制粘贴工作。
4. 在策略模式中利用组合和委托来让环境类拥有执行算法的能力，这也是继承的一种更轻便的替代方案。

策略模式的缺点：

1. 策略模式会在程序中增加许多策略类或者策略对象。
2. 要使用策略模式，必须了解所有策略类，必须了解各个策略类之间的不同点，这样才能选择合适的策略，这违反最少知识原则。

在JavaScript中，策略就是函数，可以直接作为参数传入到环境类中！
