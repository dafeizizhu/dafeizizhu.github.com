
<!DOCTYPE html>
<html>
  
  <head>
    <title>IE条件注释</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
    <meta content="text/html; charset=UTF-8" http-equiv=Content-Type />
    <meta name=author content="Zhiying.Mai" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="/assets/themes/dafeizizhu/bootstrap/css/bootstrap.min.css" />
	<link rel=stylesheet type=text/css href="/assets/themes/dafeizizhu/css/style.css" media=screen />
	<link rel=stylesheet type=text/css href="/assets/themes/dafeizizhu/css/style-responsive.css" media="screen and (max-width: 900px)"/>

	<!--[if lte IE 7]>
	<link rel="stylesheet" type="text/css" href="/assets/themes/dafeizizhu/css/style-iefixed.css" />
    <![endif]-->
  </head>
  
  <body>
    <DIV id=home class=pages>
      <DIV id=main_container>
        <DIV id="left">
          <DIV class=left_content>
            <H1>
              <A title="dafeizizhu" href="/">
                dafeizizhu
              </A>
            </H1>
            <DIV class=clear>
            </DIV>
            <DIV class=navigation>
              <UL id=slide>
                 
                


  <li class="page_item page-item-52 "><a href="/index.html">首页</a></li>
  
    
      
    
  
    
      
      	
      	<li class="page_item page-item-52"><a href="/archive.html">博文</a></li>
      	
      
    
  
    
      
      	
      	<li class="page_item page-item-52"><a href="/tags.html">标签</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  




              </UL>
            </DIV>
			<DIV>
			  <ul class="socials">
                <li class="social-weixin"><a href="http://weixin.qq.com" title="扫一扫每天获取更新内容哦亲！"></a></li>
			  </ul>
            </DIV>
          </DIV>
        </DIV>
        <DIV id="center">
          <DIV class=right_content>
            <!--<DIV id=post-52 class=postsingle>-->
            <DIV class=entry>
              
<div class="page-header">
  <h1>IE条件注释</h1>
</div>

<div class="row-fluid">
  <div class="span8">
    <p>IE条件注释提供了一个浏览器端的手段，去做浏览器检测。这个手段不需要去判断<code>window.navigator</code>，所以不用担心各种<code>navigator</code>的篡改。但是这个手段目前只能用在IE上，但是，这不就已经够了吗？</p>

<p><strong>注意，IE10已经不支持条件注释了</strong>。但是貌似IE10已经向W3的规范靠拢了，影响应该不大。</p>

<p>IE的条件注释原来有两种：</p>

<ol>
<li>不支持条件注释的浏览器不显示：<code>&lt;!--[if IE 8]&gt;...&lt;![endif]--&gt;</code></li>

<li>不支持条件注释的浏览器显示：<code>&lt;![if IE 8]&gt;...&lt;![endif]&gt;</code></li>
</ol>

<p>原理很简单，由于前者跟HTML的注释要求的格式是一样的，所以在不支持条件注释的浏览器会认为这个是一个HTML的注释，不会解析里面的HTML片段。而后者则是被认为是一个HTML标签（虽然明显不符合XML的规范……），就会解析里面的HTML片段。</p>

<p>前者可以为判断IE的版本决定是否需要加入额外的HTML、CSS、JavaScript来提供完整的功能，如在IE9以下的版本使用<code>canvas</code>，增加<code>exCanvas</code>的引用：</p>

<pre><code>&lt;!--[if lt IE 9]&gt;&lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot; src=&quot;excanvas.js&quot;&gt;&lt;/script&gt;&lt;![endif]--&gt;</code></pre>

<p>后者可以提示一些非特定版本IE的用户使用特定版本IE，如：</p>

<pre><code>&lt;![if lt IE 8]&gt;
&lt;p&gt;Please upgrade to Internet Explorer version 8.&lt;/p&gt;
&lt;![endif]&gt;</code></pre>

<p>再来看看条件注释里面的表达式，由<code>if</code>以及后面的条件表达式组成。条件表达式有三种：</p>

<ol>
<li><code>IE</code>，判断IE的版本，主版本使用整数表示，如果包含小版本则使用浮点数表示，如：<code>IE 5.5000</code>表示IE 5.5。</li>

<li><code>WindowsEdition</code>，判断浏览器运行的Windows的版本。对应的值<a href='http://msdn.microsoft.com/en-us/library/ms724358(v=vs.85).aspx'>参考这里</a>。</li>

<li>布尔值，<code>true</code>或者<code>false</code>。</li>
</ol>

<p>判断版本的时候可以使用以下几个操作符：</p>

<ol>
<li><code>lt</code>或者<code>lte</code>，判断是否小于或者小于等于特定版本。</li>

<li><code>gt</code>或者<code>gte</code>，判断是否大于或者大于等于特定版本。 3. 条件以及条件之间可以通过运算符<code>!</code>、<code>|</code>、<code>&amp;</code>进行逻辑运算。</li>
</ol>

<p>还有一个比较有趣的就是可以在IE的插件里面判断当前插件的版本！在安装插件的时候为注册表增加以下的键值：</p>

<pre><code>HKEY_LOCAL_MACHINE
  Software
    Microsoft
      Internet Explorer
        Version Vector
          Contoso = 0.9</code></pre>

<p>在插件里面可以通过以下条件注释来判断当前插件的版本：</p>

<pre><code>&lt;!--[if lt Contoso 2]&gt;
&lt;p&gt;Your version of the Contoso control is out of date; Please update to the latest.&lt;/p&gt;
&lt;![endif]--&gt;</code></pre>

<p>严格来说，使用IE条件注释也算是CSS hack的一种。相对于其他CSS hack是使用浏览器的bug实现的，这个方式算是比较靠谱的一个方式，毕竟这个不是浏览器的bug，而是浏览器提供的一种做浏览器检测的手段。如果涉及的兼容性问题只出现在各种不同版本的IE里面，为了提高代码的可读性，可以把各种fixed的代码抽取到一个外部样式表中，再使用条件注释，指示特定版本的IE加载该外部样式表。如果涉及的问题还出现在FireFox、Chrome、Safari等浏览器中，那还得考虑除了条件注释之外的css hack。</p>
    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/2013/08/14/dom-removeattribute" title="DOM 的removeAttribute方法">&larr; 上一篇</a></li>
      
        <li><a href="/archive.html">返回列表</a></li>
      
        <li class="next"><a href="/2013/08/16/css-media-query" title="响应式设计入门之media query">下一篇 &rarr;</a></li>
      
      </ul>
    </div>
    <hr>
  </div>
  
  <div class="span4">
    <h4>发布</h4>
    <div class="date"><span>15 August 2013</span></div>

  
    <h4>标签</h4>
    <ul class="tag_box">
    
    


  
     
    	<li><a href="/tags.html#html-ref">html <span>6</span></a></li>
    
  



    </ul>
    
  </div>
</div>


            </DIV>
            <DIV class=footer>
              <p>
                &copy; Zhiying.Mai 2012 with help from
                <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">
                  Jekyll Bootstrap
                </a>
                and
                <a href="http://twitter.github.com/bootstrap/" target="_blank">
                  Twitter Bootstrap
                </a>
              </p>
            </DIV>
            <!--</DIV>-->
          </DIV>
        </DIV>
      </DIV>
      
  </body>
</html>

